<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Daily Bible Verse</title>
</head>

<body>
    <div id="verse-container">
        <h2>Daily Bible Verse</h2>
        <p id="verse-content"></p>
    </div>

    <script>
        const API_KEY = 'ed1888c4b947db2e13d6acab4841fbd06340115b';

        function fetchBiblePassage() {
            const verseElement = document.getElementById("verse-content");

            fetch('https://api.esv.org/v3/passage/text/?q=Psalm+107:1', {
                headers: {
                    'Authorization': `Token ${API_KEY}`
                }
            })
                .then(response => response.json())
                .then(data => {
                    const passageText = data.passages[0].replace(/\[(\d+)\]/, ''); // Remove verse number reference from the passage
                    const verseReference = extractVerseReference(data.canonical); // Get the dynamically generated verse reference
                    const formattedText = `"${getVerseContent(passageText)}" - ${verseReference} ESV`;
                    verseElement.textContent = formattedText;
                })
                .catch(error => {
                    console.error('Error fetching ESV passage:', error);
                    verseElement.textContent = "An error occurred while fetching the passage.";
                });
        }

        // Function to extract only the verse content without additional information
        function getVerseContent(text) {
            // Remove additional information before the actual verse content
            const startIndex = text.indexOf(' '); // Find the first space character
            if (startIndex !== -1) {
                return text.substring(startIndex + 1).trim(); // Return the content after the first space
            }
            return text; // Return the original text if extraction doesn't work as expected
        }

        // Function to extract the verse reference
        function extractVerseReference(canonical) {
            const parts = canonical.split(':'); // Split the canonical string by ':'
            if (parts.length >= 2) {
                const book = parts[0];
                const verse = parts[1];
                return `${book} ${verse}`; // Return formatted verse reference
            }
            return 'Unknown Reference'; // Return a default value if extraction fails
        }

        // Call the function to fetch the Bible passage when the page loads
        fetchBiblePassage();

    </script>
</body>

</html>